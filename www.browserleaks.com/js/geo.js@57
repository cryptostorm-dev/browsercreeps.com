(function(){if(!window.google||!google.gears){var a=null;if("undefined"!=typeof GearsFactory)a=new GearsFactory;else try{a=new ActiveXObject("Gears.Factory"),-1!=a.getBuildInfo().indexOf("ie_mobile")&&a.privateSetGlobalObject(this)}catch(b){if("undefined"!=typeof navigator.mimeTypes&&navigator.mimeTypes["application/x-googlegears"])a=document.createElement("object"),a.style.display="none",a.width=0,a.height=0,a.type="application/x-googlegears",document.documentElement.appendChild(a),a&&"undefined"==typeof a.create&&(a=null)}if(a&&(window.google||(google={}),!google.gears))google.gears={factory:a}}})();var bb_success,bb_error,bb_blackberryTimeout_id=-1;function handleBlackBerryLocationTimeout(){-1!=bb_blackberryTimeout_id&&bb_error({message:"Timeout error",code:3})}function handleBlackBerryLocation(){clearTimeout(bb_blackberryTimeout_id);bb_blackberryTimeout_id=-1;if(bb_success&&bb_error){if(0==blackberry.location.latitude&&0==blackberry.location.longitude)bb_error({message:"Position unavailable",code:2});else{var a=null;blackberry.location.timestamp&&(a=new Date(blackberry.location.timestamp));bb_success({timestamp:a,coords:{latitude:blackberry.location.latitude,longitude:blackberry.location.longitude}})}bb_error=bb_success=null}}var geo_position_js=function(){var a={},b=null;a.getCurrentPosition=function(a,h,e){b.getCurrentPosition(a,h,e)};a.init=function(){try{if("undefined"!=typeof geo_position_js_simulator)b=geo_position_js_simulator;else if("undefined"!=typeof bondi&&"undefined"!=typeof bondi.geolocation)b=bondi.geolocation;else if("undefined"!=typeof navigator.geolocation)b=navigator.geolocation,a.getCurrentPosition=function(a,e,c){b.getCurrentPosition(function(d){"undefined"!=typeof d.latitude?a({timestamp:d.timestamp,coords:{latitude:d.latitude,longitude:d.longitude}}):a(d)},e,c)};else if("undefined"!=typeof window.blackberry&&blackberry.location.GPSSupported){if("undefined"==typeof blackberry.location.setAidMode)return!1;blackberry.location.setAidMode(2);a.getCurrentPosition=function(a,b,c){bb_success=a;bb_error=b;bb_blackberryTimeout_id=c.timeout?setTimeout("handleBlackBerryLocationTimeout()",c.timeout):setTimeout("handleBlackBerryLocationTimeout()",6E4);blackberry.location.onLocationUpdate("handleBlackBerryLocation()");blackberry.location.refreshLocation()};b=blackberry.location}else if("undefined"!=typeof window.google&&"undefined"!=typeof google.gears)b=google.gears.factory.create("beta.geolocation");else if("undefined"!=typeof Mojo&&"Mojo.Service.Request"!=typeof Mojo.Service.Request)b=!0,a.getCurrentPosition=function(a,b,c){parameters={};if(c){if(c.enableHighAccuracy&&!0==c.enableHighAccuracy)parameters.accuracy=1;if(c.maximumAge)parameters.maximumAge=c.maximumAge;if(c.responseTime)5>c.responseTime?parameters.responseTime=1:20>c.responseTime?parameters.responseTime=2:parameters.timeout=3}r=new Mojo.Service.Request("palm://com.palm.location",{method:"getCurrentPosition",parameters:parameters,onSuccess:function(b){a({timestamp:b.timestamp,coords:{latitude:b.latitude,longitude:b.longitude,heading:b.heading}})},onFailure:function(a){1==a.errorCode?b({code:3,message:"Timeout"}):2==a.errorCode?b({code:2,message:"Position Unavailable"}):b({code:0,message:"Unknown Error: webOS-code"+errorCode})}})};else if("undefined"!=typeof device&&"undefined"!=typeof device.getServiceObject)b=device.getServiceObject("Service.Location","ILocation"),a.getCurrentPosition=function(a,e){b.ILocation.GetLocation({LocationInformationClass:"BasicLocationInformation"},function(b,d,f){4==d?e({message:"Position unavailable",code:2}):a({timestamp:null,coords:{latitude:f.ReturnValue.Latitude,longitude:f.ReturnValue.Longitude,altitude:f.ReturnValue.Altitude,heading:f.ReturnValue.Heading}})})}}catch(g){return"undefined"!=typeof console&&console.log(g),!1}return null!=b};return a}();