<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="format-detection" content="telephone=no" /><title>HTML5 Canvas Fingerprinting — BrowserLeaks.com</title><link type="text/css" rel="stylesheet" media="all" href="js/style.css@57.css" /><script type="text/javascript">var glob=57,disqus_identifier="canvas",ping="782622453"</script><script type="text/javascript" src="js/jquery-1.11.1.min.js"></script><script type="text/javascript" src="js/plugins.js@57"></script><noscript><style type="text/css">.JS td,.JSh {opacity:0.5}</style></noscript><style type="text/css" media="all">@font-face{font-family:'Open Sans';src:url('js/h.eot');src: url('js/h.eot@') format('embedded-opentype'),url('js/h.woff') format('woff'),url('js/h.ttf') format('truetype');font-weight:600;font-style:normal;}</style><script type="text/javascript">var _gaq=_gaq || [];_gaq.push(['_setAccount','UA-30278319-1']);var hash=location.hash;if(hash&&hash.charAt(0)!='#')hash='#'+hash;_gaq.push(['_trackPageview',location.pathname+location.search+hash]);(function(){var ga=document.createElement('script');ga.type='text/javascript';ga.async=true;ga.src=('https:'==document.location.protocol?'https://ssl':'http://www')+'.google-analytics.com/ga.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(ga,s);})();</script></head><body spellcheck="false" class="mobile"><div id="noise"></div><div id="hand" class="mobile"></div><div id="logo"><a href="index.html" title="Home Page"><strong>Web Browser Security Checklist for Identity Theft Protection</strong></a></div><div id="content"><div class="twt"><noscript><a href="http://twitter.com/intent/tweet?url=https%3A%2F%2Fwww.browserleaks.com%2Fcanvas&amp;text=HTML5+Canvas+Fingerprinting+%E2%80%94+BrowserLeaks.com" title="Tweet this!" rel="nofollow">&nbsp;</a></noscript></div><div id="nav-right-logo"><a href="http://www.browserleaks.com/vpn" rel="nofollow"><img src="img/v2.gif" /></a></div><div id="nav-right-logo-2"></div><div id="nav-right"><div id="lookup-form"><h2 title="IP Lookup Tool can show you information about IP Address or Domain, such as IP-Domain Geocoding (Country, City, Latitude, Timezone), show all IP's on domain, Location on Google Maps, etc.">IP Address Lookup:</h2><form action="whois.html" method="POST"><div class="none"></div><ul><li><input type="text" id="data" name="data" class="ping" title="Leave this filed empty to get info about YOUR IP Address" /></li><li><input type="submit" id="lookup-submit" class="sprite ico-lookup" name="lookup-submit" value="" title="IP-Domain Lookup" /></li></ul></form></div></div><div id="canvas-fingerprint" class="JS"><header><h1><a href="canvas.html" class="client-side">HTML5 Canvas Fingerprinting</a></h1></header><script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:inline-block;width:890px;height:90px" data-ad-slot="1319586667"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({params:{google_ad_client:"ca-pub-"+(1765987198293794+1550104280767849+1278738493849057)}});</script><noscript><div class="warn">JavaScript Disabled &mdash; Canvas element is part of HTML5, but it also requires JavaScript</div></noscript><div id="warn-canvas" class="warn none">This browser does not support HTML5 Canvas</div><p>This is a simple Proof-of-Concept that Browser Fingerprinting is possible without any of User-Agent identifiers.</p><p>The method is based on the fact that the same HTML5 Canvas element can produce exceptional pixels on a different web browsers, depending on the system on which it was executed.</p><p>This happens for several reasons: at the image format level &mdash; web browsers uses different image processing engines, export options, compression level, final images may got different hashes even if they are pixel-perfect; at the pixmap level &mdash; operating systems use different algorithms and settings for anti-aliasing and sub-pixel rendering. We don't know all the reasons, but we have already collected more than a thousand unique signatures.</p><p>Well, let's begin. After the tables we give a brief explanation…</p><table><tr class="thead"><td colspan="2"><h3>Canvas Support in Your Browser</h3></td></tr><tr><td>Canvas (basic support)</td><td colspan="3" id="mzr-canvas"><span class="bad">&#215;</span> False</td></tr><tr><td>Text API for Canvas</td><td colspan="3" id="mzr-canvas-text"><span class="bad">&#215;</span> False</td></tr></table><table><tr class="thead"><td colspan="2"><h3>Database Summary</h3></td></tr><tr><td>Total Visitors Processed</td><td id="db-visitors"></td></tr><tr><td>Total Sets (User-Agents)</td><td id="db-sets"></td></tr><tr><td>Total Groups (Signatures)</td><td id="db-groups"></td></tr></table><table class="NOCANVAS"><tr class="thead"><td colspan="2"><h3>Your Fingerprint</h3></td></tr><tr><td>Signature</td><td id="crc"></td></tr><tr><td>Found in DB</td><td colspan="3" id="crc-detect"></td></tr><tr><td>General Conclusion</td><td id="crc-verdict"><span id="crc-verdict-true" class="none">It is very likely that you are using <span id="crc-verdict-ua">Web Browser</span> on <span id="crc-verdict-os">Operating System</span></span> <span id="crc-verdict-false" class="none">Your system fingerprint appears to be unique, yet we don't collect signatures here, just check.</span></td></tr></table><table id="canvas-table" class="NOCANVAS"><tr class="thead"><td colspan="6"><h3>User-Agents with the same Signature</h3></td></tr><tr><td colspan="2">Sets in this Group</td><td  colspan="4" id="crc-count"></td></tr></table><h3 class="warn-help" id="scope-of-the-issue" name="scope-of-the-issue"><a href="canvas.html#scope-of-the-issue" title="Click to expand">Scope of the Issue</a></h3><div><p>Unlike the other &laquo;browser detection&raquo; tricks, it deals with many OS features related on graphics environment. Potentially it can be used to identify the video adapter, especially if you are use WebGL profiling, not just Canvas 2D Context. By the way different graphics card drivers can also sometimes affect to regular fonts rendering.</p><p>This technique is good to make a unique/trackable signature when it is combined with other common methods, e.g. in systems such as EFF's Panopticlick or PET's Fingerprinting.</p><p>Much more difficult to obtain specific parameters of the system. It is signature-based, and the problem of signature collection is the main limiting factor why it is not so easy at the moment. We can produce Canvas/WebGL pixmap, and associate its fingerprint with own machine, but we cannot ask each visitor individually about his system and hardware. Certainly, there are ways to get such info: malware, social engineering, mturk, but for now we do not consider them, for now :)</p></div><h3 class="warn-help" id="how-does-it-work" name="how-does-it-work"><a href="canvas.html#how-does-it-work" title="Click to expand">How Does It Work</a></h3><div><p>First of all, there will be no any ready-to-embed solutions, this is only demo. We are just going to share some snippets how it works under the hood.</p><p>Our signatures DB is based on a simple association between &laquo;Canvas Fingerprint&raquo; and &laquo;HTTP User-Agent&raquo;, so it is very prone to false positives because of the faked headers, etc. If your fingerprint matches one that is stored in database, the program will show you which User-Agents have the same signature. Otherwise, well, your browser seems unique for our modest DB, but we cannot sign you here in any way, because we do not collect signatures from this website.</p><p>Here is the javascript code that produce the pixels:</p><ol class="code" contenteditable="true" spellcheck="false"><li><span><span class="c">// text with lowercase/uppercase/punctuation symbols</span></span></li><li><span><span class="z">var</span> txt = <span class="x">"BrowserLeaks,com &lt;canvas&gt; 1.0"</span>;</span></li><li><span>ctx.textBaseline = <span class="x">"top"</span>;</span></li><li><span><span class="c">// the most common type</span></span></li><li><span>ctx.font = <span class="x">"14px 'Arial'"</span>;</span></li><li><span>ctx.textBaseline = <span class="x">"alphabetic"</span>;</span></li><li><span>ctx.fillStyle = <span class="x">"#f60"</span>;</span></li><li><span>ctx.fillRect(125,1,62,20);</span></li><li><span><span class="c">// some tricks for color mixing</span></span></li><li><span>ctx.fillStyle = <span class="x">"#069"</span>;</span></li><li><span>ctx.fillText(txt, 2, 15);</span></li><li><span>ctx.fillStyle = <span class="x">"rgba(102, 204, 0, 0.7)"</span>;</span></li><li><span>ctx.fillText(txt, 4, 17);</span></li><li><span><span class="c">// more explanation? see the Further Reading below...</span></span></li></ol><table><tr><td>The result will be the image</td><td><div id="img"><span class="bad">&#215;</span><noscript>JavaScript Disabled or </noscript>Your browser does not support HTML5 Canvas</div></td></tr></table><p>To create a signature from the canvas, we must export the pixels from the application's memory using the toDataURL() method, which will return the base64-encoded string of the binary image file. Then we can just create MD5 hash of this string.</p><p>But for the PoC we came up with a slightly more interesting decision. As we know, PNG files is divided into chunks, and last part of each chunk is a 32-bit CRC checksum calculated on the preceding bytes. So all we need is to extract the IDAT CRC &mdash; that will be the browser fingerprint:</p><ol class="code" contenteditable="true" spellcheck="false"><li><span><span class="c">// code is simple but we must provide some conversion functions</span></span></li><li><span><span class="c">// it is still less and faster than md5</span></span></li><li><span> </span></li><li><span><span class="z">function</span> bin2hex (s) {</span></li><li><span>    <span class="c">// ... bin-to-hex conversion code ...</span></span></li><li><span>}</span></li><li><span> </span></li><li><span><span class="z">if</span> (typeof window.atob == <span class="x">"undefined"</span>) {</span></li><li><span>    <span class="z">function</span> atob(a) {</span></li><li><span>    <span class="c">// IE9 still has not atob() function (base64-to-binary)</span></span></li><li><span>    <span class="c">// ... you must put some replacement here ...</span></span></li><li><span>    }</span></li><li><span>}</span></li><li><span> </span></li><li><span><span class="z">var</span> b64 = canvas.toDataURL.replace(<span class="x">"data:image/png;base64,"</span>,<span class="x">""</span>);</span></li><li><span><span class="z">var</span> bin = atob(b64);</span></li><li><span> </span></li><li><span><span class="c">// crc32 takes only 4 bytes and placed from 16 to 12 byte from the end of file</span></span></li><li><span><span class="z">var</span> crc = bin2hex(bin.slice(-16,-12));</span></li></ol></div><h3 class="warn-help" id="further-reading" name="further-reading"><a href="canvas.html#further-reading" title="Click to expand">Further Reading</a></h3><div><ol class="list"><li><a href="http://www.useragentman.com/blog/2009/11/29/how-to-detect-font-smoothing-using-javascript/">How to Detect Font-Smoothing Using JavaScript</a></li><li><a href="http://cseweb.ucsd.edu/~hovav/dist/canvas.pdf">Pixel Perfect: Fingerprinting Canvas in HTML5</a></li><li><a href="https://panopticlick.eff.org">Panopticlick. How Unique, and Trackable, Is Your Browser?</a></li><li><a href="https://www.browserleaks.com/webgl">WebGL Browser Report. BrowserLeaks</a></li><li><a href="https://developer.mozilla.org/en-US/docs/HTML/Canvas">HTML5 Canvas. Mozilla Developer Network</a></li><li><a href="http://caniuse.com/#search=canvas">Compatibility tables for support of Canvas & WebGL in desktop and mobile browsers.</a></li><li><a href="http://www.w3.org/TR/PNG/">Portable Network Graphics (PNG) Specification</a></li></ol></div></div><script type="text/javascript">/* @CC_SKIP< */if (typeof window.atob == 'undefined') {function atob(a){var b="",e,c,h="",f,g="",d=0;k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";do e=k.indexOf(a.charAt(d++)),c=k.indexOf(a.charAt(d++)),f=k.indexOf(a.charAt(d++)),g=k.indexOf(a.charAt(d++)),e=e<<2|c>>4,c=(c&15)<<4|f>>2,h=(f&3)<<6|g,b+=String.fromCharCode(e),64!=f&&(b+=String.fromCharCode(c)),64!=g&&(b+=String.fromCharCode(h));while(d<a.length);return unescape(b)};}/* @CC_SKIP> */window.Modernizr=function(a,b,c){var d={},e=b.documentElement;a=b.createElement("modernizr");a=a.style;var f={},m=[],j=m.slice,g,k={}.hasOwnProperty,h;"undefined"!==typeof k&&"undefined"!==typeof k.call?h=function(a,b){return k.call(a,b)}:h=function(a,b){return b in a&&"undefined"===typeof a.constructor.prototype[b]};Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if("function"!=typeof b)throw new TypeError;var c=j.call(arguments,1),d=function(){if(this instanceof d){var e=function(){};e.prototype=b.prototype;var e=new e,f=b.apply(e,c.concat(j.call(arguments)));return Object(f)===f?f:e}return b.apply(a,c.concat(j.call(arguments)))};return d});f.canvas=function(){var a=b.createElement("canvas");return!!a.getContext&&!!a.getContext("2d")};f.canvastext=function(){var a;if(a=!!d.canvas)a="function"===typeof b.createElement("canvas").getContext("2d").fillText;return a};for(var l in f)h(f,l)&&(g=l.toLowerCase(),d[g]=f[l](),m.push((d[g]?"":"no-")+g));d.addTest=function(a,b){if("object"==typeof a)for(var f in a)h(a,f)&&d.addTest(f,a[f]);else{a=a.toLowerCase();if(d[a]!==c)return d;b="function"==typeof b?b():b;"undefined"!=typeof enableClasses&&enableClasses&&(e.className+=" "+(b?"":"no-")+a);d[a]=b}return d};a.cssText="";return a=null,d._version="2.6.2",d}(this,this.document);(function(){var a=!0;Modernizr.canvas?$("#mzr-canvas").html('<span class="good">&#10004;</span> True'):a=!1;Modernizr.canvastext?$("#mzr-canvas-text").html('<span class="good">&#10004;</span> True'):a=!1;a?(a=draw_canvas(),post_ajax(a)):($("#warn-canvas").removeClass("none"),$(".NOCANVAS").css("opacity","0.5"),post_ajax("ffffffff"))})();function bin2hex(a){var b,c,d="",e;a+="";b=0;for(c=a.length;b<c;b++)e=a.charCodeAt(b).toString(16),d+=2>e.length?"0"+e:e;return d}function draw_canvas(){var a=document.createElement("canvas");a.setAttribute("width",220);a.setAttribute("height",30);var b=a.getContext("2d");b.textBaseline="top";b.font="14px 'Arial'";b.textBaseline="alphabetic";b.fillStyle="#f60";b.fillRect(125,1,62,20);b.fillStyle="#069";b.fillText("BrowserLeaks,com <canvas> 1.0",2,15);b.fillStyle="rgba(102, 204, 0, 0.7)";b.fillText("BrowserLeaks,com <canvas> 1.0",4,17);a=a.toDataURL("image/png");b=atob(a.replace("data:image/png;base64,",""));$("#img").css("height","25px").html('<img src="http://www.browserleaks.com/'+a+'" title="Your Live Image" alt="HTML5 Canvas Fingerprint" />');return bin2hex(b.slice(-16,-12))}function post_ajax(a){$.ajax({type:"GET",url:"/xhr/canvas/"+a,async:!0,dataType:"json"}).done(function(b){"undefined"!=typeof b.db&&($("#db-visitors").text(b.db.visitors),$("#db-sets").text(b.db.sets),$("#db-groups").text(b.db.groups));"ffffffff"!=a&&("undefined"!==typeof b[a]?("not_listed"!=b[a]?($("#crc").text(a.toUpperCase()),$("#crc-detect").html('<span class="good">&#10004;</span> True'),$("#crc-verdict-ua").text("["+b[a].ua[0][0]+"]"),$("#crc-verdict-os").text("["+b[a].os[0][0]+"]"),$("#crc-verdict-true").removeClass("none"),$("#crc-count").text(b[a].count+"/"+b.db.sets),draw_table(b[a])):($("#crc").text(a.toUpperCase()),$("#crc-detect").html('<span class="bad">&#215;</span> False'),$("#crc-verdict-false").removeClass("none"),$("#crc-count").text("0/"+b.db.sets)),"a4e1854e"==a&&$("#crc-verdict").html('<span class="unknown">?</span>Canvas Protection was detected, it seems that Tor Browser is here!')):($("#crc").text(a.toUpperCase()),$("#crc-detect").html('<span class="bad">&#215;</span> Unknown Error'),$("#crc-count").text("0/"+b.db.sets)))})}function draw_table(a){var b=0,c;for(c in a)b<a[c].length&&(b=a[c].length);b=a.os.length+a.os_ver.length;a.ua.length+a.ua_ver.length>b&&(b=a.ua.length+a.ua_ver.length);a.device.length+a.platform.length>b&&(b=a.device.length+a.platform.length);b+=1;c='<tr><td class="th r" colspan="2"><h3>Operating Systems</h3></td><td class="th r" colspan="2"><h3>Browsers</h3></td><td class="th" colspan="2"><h3>Devices</h3></td></tr>';for(var d=i_pc=is_pc=i_ua=is_ua=i_os=is_os=0;d<b;d++)c+="<tr>","undefined"!=typeof a.os[d]?(i_os++,c+="<td>"+a.os[d][0]+'</td><td class="r">'+a.os[d][1]+"/"+a.count+"</td>"):"undefined"!=typeof a.os_ver[d-i_os]?0==is_os?(i_os++,is_os=1,c+='<td class="t th r" colspan="2"><h3>OS by Version</h3></td>'):c+="<td>"+a.os_ver[d-i_os][0]+'</td><td class="r">'+a.os_ver[d-i_os][1]+"/"+a.count+"</td>":c+='<td></td><td class="r"></td>',"undefined"!=typeof a.ua[d]?(i_ua++,c+="<td>"+a.ua[d][0]+'</td><td class="r">'+a.ua[d][1]+"/"+a.count+"</td>"):"undefined"!=typeof a.ua_ver[d-i_ua]?0==is_ua?(i_ua++,is_ua=1,c+='<td class="t th r" colspan="2"><h3>Browsers by Version</h3></td>'):c+="<td>"+a.ua_ver[d-i_ua][0]+'</td><td class="r">'+a.ua_ver[d-i_ua][1]+"/"+a.count+"</td>":c+='<td></td><td class="r"></td>',"undefined"!=typeof a.device[d]?(i_pc++,c+="<td>"+a.device[d][0]+"</td><td>"+a.device[d][1]+"/"+a.count+"</td>"):"undefined"!=typeof a.platform[d-i_pc]?0==is_pc?(i_pc++,is_pc=1,c+='<td class="t th" colspan="2"><h3>Platforms</h3></td>'):c+="<td>"+a.platform[d-i_pc][0]+"</td><td>"+a.platform[d-i_pc][1]+"/"+a.count+"</td>":c+="<td></td><td></td>",c+="</tr>";$("#canvas-table").append(c);clck()};</script><noscript><div id="warn-comments-nojs"></noscript><h3 class="warn-help warn-comments" id="comments" name="comments"><a href="canvas.html#comments">Leave a Comment</a></h3><div id="disqus_thread"></div><noscript></div></noscript><div class="twt foot"><noscript><a href="http://twitter.com/intent/tweet?url=https%3A%2F%2Fwww.browserleaks.com%2Fcanvas&amp;text=HTML5+Canvas+Fingerprinting+%E2%80%94+BrowserLeaks.com" title="Tweet this!" rel="nofollow">&nbsp;</a></noscript></div></div><nav><div id="nav"><div id="nav-pin"><form name="nav-pin-form" id="nav-pin-form" method="post" action="canvas.html" onsubmit="return false"><input type="submit" id="nav-pin-submit" name="nav-pin-submit" value="Desktop Version" title="Desktop Version" /></form></div><div id="nav-hover"><div id="nav-menu" class="bs"><ul><li class="margin"><a class="ico-index" href="index.html" title="Home Page">Home Page</a></li><li><a class="ico-whois" href="whois.html" title="IP Address Whois and Geocoding">IP Address</a></li><li><a class="ico-javascript" href="javascript.html" title="JavaScript Browser Information">JavaScript</a></li><li><a class="ico-flash" href="flash.html" title="Flash Player System Capabilities">Flash Player</a></li><li><a class="ico-silverlight" href="silverlight.html" title="Silverlight">Silverlight</a></li><li><a class="ico-java" href="java.html" title="Java VM System Properties">Java Applet</a></li><li><a class="ico-webgl" href="webgl.html" title="WebGL Browser Report">WebGL</a></li><li class="margin"><a class="ico-webrtc" href="webrtc.html" title="WebRTC">WebRTC</a></li><li><a class="ico-fonts" href="fonts.html" title="System Fonts Detection via Flash">System Fonts</a></li><li><a class="ico-proxy" href="proxy.html" title="Content Filtering Proxy Software Detection">Content Filters</a></li><li><a class="ico-geo" href="geo.html" title="HTML5 Geolocation API and Reverse Geocoding">Geolocation API</a></li><li><a class="ico-donottrack" href="donottrack.html" title="Do Not Track Tester">Do Not Track</a></li><li><span class="this ico-canvas" title="HTML5 Canvas Fingerprinting">Canvas Fingerprint</span></li><li class="margin"><a class="ico-modernizr" href="modernizr.html" title="Modernizr Helper">Modernizr Helper</a></li><li><a class="ico-preferences" href="preferences.html" title="Personal Site Preferences" rel="nofollow">Site Preferences</a></li></ul></div></div></div></nav><footer><div id="footer">BrowserLeaks.com &copy; 2015 All Right Reserved<br /><bdo dir="rtl">m<!-- q -->oc.l<!-- w -->iam<!-- r -->g@sk<!-- t -->aelre<!-- y -->swor<!-- u -->b:ot<!-- i -->lia<!-- o -->m</bdo></div></footer><!--[if lt IE 9]><script>document.createElement("header");document.createElement("footer");document.createElement("section");document.createElement("nav");document.createElement("article");</script><![endif]--></body></html>